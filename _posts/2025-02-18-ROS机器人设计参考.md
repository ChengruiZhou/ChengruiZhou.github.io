---
title: "ROS机器人设计参考."
header:
  overlay_color: "#333"
categories: 
  - ROS2
---



## 1.硬件总体设计

参考来源：[小白机器人 — newbot 1.1.0 文档](https://newbot.readthedocs.io/zh-cn/latest/index.html)

做硬件，首先要确定一下小白机器人的核心CPU，有近些年火热的ESP32和昂贵的Linux SOC两种选择，最终还是选择了能跑Linux的RK3566芯片，虽然价格昂贵、功耗高、发热重、体积大，但是在Linux系统下编程更加自由，功能更加容易扩展，有大量的开源项目可供使用，不必自己重新造轮子，例如下文中会提到的强大的ros系统。
确定了处理器之后，机器人上肯定少不了一块液晶屏，为的是和用户进行人机交互，显示个表情包啥的，提供必要的情绪价值。
要想让机器人能看见这个世界，必须需要安装一个摄像头；要机器人能听会说，麦克风和扬声器也是必须要的；要实现机器人能走路，最简单的方式就是安装两个差速轮，并且为了支持它到处跑，电池供电也是必不可少的。
另外为了机器人在室内环境中能够避障和导航，我还为小白机器人的顶部配备了单线激光雷达；为了实现机器人常见的离线命令词控制，内置了离线语音芯片；为了实现待机充电，在机器人内部做了电源切换和充电电路。

## 1.软件整体框架

### (1)ROS系统简介

ROS（机器人操作系统，Robot Operating System），是专为机器人软件开发所设计出来的一套电脑操作系统架构。小白机器人的软件在ROS框架下构建，需要掌握ROS基本的命令行工具、可视化工具、工程编译方法、ROS Launch文件、C++和Python语言等ROS开发基础。

推荐ROS入门课程：

ROS官方教程  https://wiki.ros.org/cn

古月居GYH [【古月居】古月·*ROS*入门21讲 | 一学就会的*ROS*机器人入门教程](https://www.bilibili.com/video/BV1zt411G7Vn/)

机器人工匠阿杰 [机器人操作系统 *ROS* 快速入门教程](https://www.bilibili.com/video/BV1BP4y1o7pw/)



ROS包括了通信机制、开发工具、应用功能和生态系统四个部分：

![ros](/pictures/2025-02/imgs/ros.png)



ROS的通信机制主要有Topic、Service、Action三大方式，最常用的是Topic：

![ros_topic](/pictures/2025-02/imgs/ros_topic.png)

ROS常用的可视化工具有rviz、rqt、rqt_image_view、rqt_graph、rqt_plot等，ROS主要应用于移动机器人底盘（SLAM、NAV）、机械臂（MoveIt）和底盘与机械臂结合的复合机器人。

![rviz](/pictures/2025-02/imgs/rviz.png)

### (2)本系统的主要软件功能

这是本项目的三大主要软件功能，包括了语音交互、图像识别、移动导航。

![software](/pictures/2025-02/imgs/software.png)

### (3)本系统的ROS节点图

左侧是图像的采集处理流程，先读取USB相机原始的JPEG格式数据，然后解码和缩放，送入yolov6处理模块，处理得到检测框和绘制了检测框的图像，然后送入跟踪模块，得到绘制了跟踪结果的图像，最后送到JPEG编码节点，发布出去方便电脑或手机接收查看。

注意这里的解码、缩放以及最后的编码都是调用了RK3566的硬件编解码能力，而yolov6使用了RK3566 RKNN的AI加速能力。

![img_pipeline](/pictures/2025-02/imgs/img_pipeline.png)

右侧是其他处理流程，包括了底盘控制节点base_control，雷达驱动节点/m1c1_mini，离线唤醒命令处理节点wakeup_process，纯python编写的语音处理节点audio，精确移动和旋转命令执行节点/move_client_cmd和/move_server。下文会对核心的几个节点做简单介绍。

![graph](/pictures/2025-02/imgs/graph.png)


